# Архитектурное решение по кешированию

## Какую часть системы имеет смысл закэшировать
- CRM: кэширование "холодных" данных (старые заказы, архивные данные).
- MES: кэширование результатов расчётов.
- API: кэширование часто запрашиваемых данных, например расчетные стоимости.
- Internet shop: кэширование статики для ускорения загрузки страниц.


## Мотивация
Для ускорения загрузки интернет-магазина, уменьшения нагрузки на БД и сервисы.


## Предлагаемое решение
- Cache-Aside для CRM, MES и API, тк эти компоненты работают с данными, которые изменяются редко или зависят от входных параметров.
- Write-Through для кэширования статики в интернет-магазине, тк он гарантирует актуальность данных при их обновлении.

### Диаграмма последовательности действий
[Sequence диаграмма операции чтения списка заказов и записи об изменении статуса заказа](orders.sequence.puml)

### Стратегия инвалидации кеша

| Компонент                   | Стратегия инвалидации       | Обоснование                                                                 | Почему не другие?                                                          |
|-----------------------------|-----------------------------|-----------------------------------------------------------------------------|----------------------------------------------------------------------------|
| **CRM**                     | Инвалидация по ключу        | "Холодные" данные изменяются редко, требуется точечная инвалидация.         | TLT избыточен, программная инвалидация не нужна из-за редких изменений.    |
| **MES**                     | Инвалидация по ключу        | Результаты расчётов зависят от входных данных, требуется точечная инвалидация. | TLT избыточен, программная инвалидация не нужна из-за простой логики.      |
| **API**                     | Временная инвалидация (TTL) | Данные могут изменяться со временем, TLT обеспечивает баланс актуальности.  | Инвалидация по ключу сложна, программная инвалидация избыточна.            |
| **Internet shop (статика)** | Программная инвалидация     | Статика обновляется редко, но должна быть актуальна сразу после изменения.  | TLT избыточен, инвалидация по ключу не нужна из-за редких изменений.       |

